<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Wildlife Surveillance Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
      background-color: #f4f4f9;
      color: #333;
    }

    h1 {
      text-align: center;
    }

    .metrics {
      display: flex;
      justify-content: space-around;
      margin: 20px 0;
    }

    .metric-box {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      padding: 20px;
      width: 25%;
      text-align: center;
    }

    .charts {
      display: flex;
      justify-content: space-around;
      margin-top: 40px;
    }

    canvas {
      background: #fff;
      padding: 20px;
      border-radius: 12px;
    }
  </style>
</head>
<body>

<h1>Wildlife Surveillance Dashboard</h1>

<div class="metrics">
  <div class="metric-box">
    <h2 id="total">0</h2>
    <p>Total Animals Detected</p>
  </div>
  <div class="metric-box">
    <h2 id="males">0</h2>
    <p>Number of Males</p>
  </div>
  <div class="metric-box">
    <h2 id="females">0</h2>
    <p>Number of Females</p>
  </div>
</div>

<div class="charts">
  <canvas id="genderChart" width="400" height="400"></canvas>
  <canvas id="speciesChart" width="400" height="400"></canvas>
</div>

<script>
  // Simulated Data - Replace this with a real fetch() call from your backend
  const detectionData = [
    { animal: "tiger", gender: "male" },
    { animal: "elephant", gender: "female" },
    { animal: "leopard", gender: "male" },
    { animal: "deer", gender: "female" },
    { animal: "deer", gender: "female" },
    { animal: "tiger", gender: "male" },
    { animal: "elephant", gender: "male" }
  ];

  function calculateMetrics(data) {
    const total = data.length;
    const male = data.filter(d => d.gender === "male").length;
    const female = data.filter(d => d.gender === "female").length;

    const speciesCount = {};
    data.forEach(d => {
      speciesCount[d.animal] = (speciesCount[d.animal] || 0) + 1;
    });

    // Update text
    document.getElementById("total").innerText = total;
    document.getElementById("males").innerText = male;
    document.getElementById("females").innerText = female;

    return { male, female, speciesCount };
  }

  function renderCharts(metrics) {
    const genderCtx = document.getElementById("genderChart").getContext("2d");
    new Chart(genderCtx, {
      type: "doughnut",
      data: {
        labels: ["Male", "Female"],
        datasets: [{
          data: [metrics.male, metrics.female],
          backgroundColor: ["#36a2eb", "#ff6384"]
        }]
      },
      options: {
        responsive: false
      }
    });

    const speciesCtx = document.getElementById("speciesChart").getContext("2d");
    new Chart(speciesCtx, {
      type: "bar",
      data: {
        labels: Object.keys(metrics.speciesCount),
        datasets: [{
          label: "Animals Detected",
          data: Object.values(metrics.speciesCount),
          backgroundColor: "#4bc0c0"
        }]
      },
      options: {
        responsive: false
      }
    });
  }

  const metrics = calculateMetrics(detectionData);
  renderCharts(metrics);
  


  var data = [{
    x: ['Male', 'Female'],
    y: [10, 15],
    type: 'bar'
  }];

  Plotly.newPlot('myPlot', data);

</script>

</body>
</html>
